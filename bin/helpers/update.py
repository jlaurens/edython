"""
Generates a dependency javascript file from a directory.
Build test html files.
"""

import re, os, stat, json
from my_util import *
from pathlib import Path
import datetime

def update_inline_test():
  print('Updating inline tests...')
  tests = (x for x in path_js.rglob('*.test.js') if x.is_file())
  for p_test in tests:
    p_base = p_test.parent / (p_test.stem.split('.')[0])
    p_js = p_base.with_suffix('.js')
    it = getInlineTest(p_js)
    p_inline = p_base.with_suffix('.test.inline.js')
    if len(it):
      p_inline.write_text(f'// This file was generated by "update.py" on {datetime.datetime.utcnow()}\n\n' + it)
    else:
      try:
        p_inline.unlink()
      except FileNotFoundError:
        pass
  print('... DONE')
  return 0

if __name__ == "__main__":
  
  out = update_inline_test()

  exit(out)
